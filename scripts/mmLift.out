
R version 4.5.0 (2025-04-11) -- "How About a Twenty-Six"
Copyright (C) 2025 The R Foundation for Statistical Computing
Platform: aarch64-apple-darwin20

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> # mmLift.R
> # R to model effect of upzoning on relative price of land and improvements
> # Tom Davidoff
> 
> library(data.table)
> library(ggplot2)
> library(fixest)
> library(geosphere)
> 
> ds <- fread("data/derived/sales.csv")
> dd <- fread("data/derived/descriptions.csv")
> da <- fread("data/derived/assessments.csv")
> dc <- fread("data/derived/folioCentroids.csv")
> 
> df <- merge(ds,dd,by="FOLIO_ID")
> df <- merge(df,da,by="FOLIO_ID")
> df <- merge(df,dc,by="FOLIO_ID")
> 
> # find distance to transit
> dt <- fread("data/derived/todList.csv")
> print(summary(dt))
      Item    Station Name         Longitude         Latitude    
 Min.   : 1   Length:29          Min.   :-123.2   Min.   :49.20  
 1st Qu.: 8   Class :character   1st Qu.:-123.1   1st Qu.:49.25  
 Median :15   Mode  :character   Median :-123.1   Median :49.26  
 Mean   :15                      Mean   :-123.1   Mean   :49.26  
 3rd Qu.:22                      3rd Qu.:-123.1   3rd Qu.:49.27  
 Max.   :29                      Max.   :-123.0   Max.   :49.29  
 Type of Transit Station
 Length:29              
 Class :character       
 Mode  :character       
                        
                        
                        
> df[,maxFSR:=0]
> print(table(dt[,get("Type of Transit Station")]))

          bus exchange passenger rail station 
                     2                     27 
> for (i in 1:nrow(dt)) {
+ 	df[,disti:=distGeo(cbind(lon,lat),c(dt[i,Longitude],dt[i,Latitude]))]
+ 	if (dt[i,`Type of Transit Station`]=="passenger rail station") {
+ 		df[,maxi:=ifelse(disti<200,5,ifelse(disti<400,4,ifelse(disti<800,3,0)))]
+ 	}
+ 	if (dt[i,`Type of Transit Station`]=="bus exchange") {
+ 		df[,maxi:=ifelse(disti<200,4,ifelse(disti<400,3,0))]
+ 	}
+ 	df[,maxFSR:=pmax(maxFSR,maxi,na.rm=TRUE)]
+ }	
> print(summary(df[,maxFSR]))
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
0.00000 0.00000 0.00000 0.09797 0.00000 5.00000 
> 
> print(df[1:20])
Key: <FOLIO_ID>
      FOLIO_ID CONVEYANCE_DATE          CONVEYANCE_TYPE_DESCRIPTION
        <char>          <IDat>                               <char>
 1: A00000000E      2023-05-18 Improved Single Property Transaction
 2: A00000000F      2024-04-30 Improved Single Property Transaction
 3: A00000000U      2023-10-20 Improved Single Property Transaction
 4: A00000000X      2023-09-05 Improved Single Property Transaction
 5: A00000002B      2023-10-23 Improved Single Property Transaction
 6: A00000002P      2024-01-04 Improved Single Property Transaction
 7: A00000002T      2023-10-04 Improved Single Property Transaction
 8: A00000002V      2023-06-15 Improved Single Property Transaction
 9: A00000003A      2024-03-14 Improved Single Property Transaction
10: A00000003K      2024-03-07 Improved Single Property Transaction
11: A00000003K      2024-03-07 Improved Single Property Transaction
12: A000000044      2024-12-27 Improved Single Property Transaction
13: A00000004D      2024-05-01 Improved Single Property Transaction
14: A000000052      2024-01-04 Improved Single Property Transaction
15: A00000008E      2024-07-16 Improved Single Property Transaction
16: A00000008Y      2023-10-30 Improved Single Property Transaction
17: A0000000A0      2024-02-07 Improved Single Property Transaction
18: A0000000A0      2024-02-07 Improved Single Property Transaction
19: A0000000AT      2024-08-01 Improved Single Property Transaction
20: A0000000BP      2024-01-23 Improved Single Property Transaction
      FOLIO_ID CONVEYANCE_DATE          CONVEYANCE_TYPE_DESCRIPTION
    CONVEYANCE_PRICE          ACTUAL_USE_DESCRIPTION     ROLL_NUMBER
               <int>                          <char>          <char>
 1:         11800000          Single Family Dwelling 001019635070000
 2:         17000000          Single Family Dwelling 001019635170000
 3:         11600000          Single Family Dwelling 001019635860000
 4:          8800000          Single Family Dwelling 001019636070000
 5:          4000000          Single Family Dwelling 001024636740002
 6:          4275000          Single Family Dwelling 001024637820000
 7:         14120000          Single Family Dwelling 001025638280000
 8:          9750000          Single Family Dwelling 001025638660000
 9:          3250000          Single Family Dwelling 001027683460000
10:          4285000 Residential Dwelling with Suite 001028655960000
11:          4285000 Residential Dwelling with Suite 001028655960000
12:          3900000          Single Family Dwelling 001029650810000
13:          5070000          Single Family Dwelling 001030683970000
14:          2258888          Single Family Dwelling 001032686790000
15:         43706110          Single Family Dwelling 001630020040000
16:          9000000          Single Family Dwelling 001630022440000
17:          7880000          Single Family Dwelling 001630037680000
18:          7880000          Single Family Dwelling 001630037680000
19:         35750000          Single Family Dwelling 001632019550000
20:          4135000          Single Family Dwelling 001632022270000
    CONVEYANCE_PRICE          ACTUAL_USE_DESCRIPTION     ROLL_NUMBER
    JURISDICTION_CODE      JURISDICTION LAND_WIDTH LAND_SIZE LAND_DEPTH
                <int>            <char>      <num>     <num>      <num>
 1:               200 City of Vancouver         NA     0.853         NA
 2:               200 City of Vancouver         NA     1.354         NA
 3:               200 City of Vancouver         NA     0.939         NA
 4:               200 City of Vancouver         NA     1.524         NA
 5:               200 City of Vancouver         NA  2846.000         NA
 6:               200 City of Vancouver         NA  4600.000         NA
 7:               200 City of Vancouver         NA  9834.000         NA
 8:               200 City of Vancouver         NA  8357.000         NA
 9:               200 City of Vancouver       61.0        NA      99.00
10:               200 City of Vancouver         NA  9697.000         NA
11:               200 City of Vancouver         NA  9697.000         NA
12:               200 City of Vancouver       55.0        NA     122.63
13:               200 City of Vancouver       60.9        NA     110.00
14:               200 City of Vancouver       33.0        NA     105.60
15:               200 City of Vancouver         NA 29103.000         NA
16:               200 City of Vancouver       60.0        NA     100.80
17:               200 City of Vancouver       43.5        NA     132.30
18:               200 City of Vancouver       43.5        NA     132.30
19:               200 City of Vancouver         NA     1.113         NA
20:               200 City of Vancouver       60.0        NA     100.00
    JURISDICTION_CODE      JURISDICTION LAND_WIDTH LAND_SIZE LAND_DEPTH
    NEIGHBOURHOOD REGIONAL_DISTRICT TENURE_DESCRIPTION
           <char>            <char>             <char>
 1:    Point Grey   Metro Vancouver      Crown-Granted
 2:    Point Grey   Metro Vancouver      Crown-Granted
 3:    Point Grey   Metro Vancouver      Crown-Granted
 4:    Point Grey   Metro Vancouver      Crown-Granted
 5:    Point Grey   Metro Vancouver      Crown-Granted
 6:    Point Grey   Metro Vancouver      Crown-Granted
 7:    Point Grey   Metro Vancouver      Crown-Granted
 8:    Point Grey   Metro Vancouver      Crown-Granted
 9:    Point Grey   Metro Vancouver      Crown-Granted
10:    Point Grey   Metro Vancouver      Crown-Granted
11:    Point Grey   Metro Vancouver      Crown-Granted
12:    Point Grey   Metro Vancouver      Crown-Granted
13:    Point Grey   Metro Vancouver      Crown-Granted
14:    Point Grey   Metro Vancouver      Crown-Granted
15:    Point Grey   Metro Vancouver      Crown-Granted
16:    Point Grey   Metro Vancouver      Crown-Granted
17:    Point Grey   Metro Vancouver      Crown-Granted
18:    Point Grey   Metro Vancouver      Crown-Granted
19:    Point Grey   Metro Vancouver      Crown-Granted
20:    Point Grey   Metro Vancouver      Crown-Granted
    NEIGHBOURHOOD REGIONAL_DISTRICT TENURE_DESCRIPTION
    GEN_NET_IMPROVEMENT_VALUE GEN_NET_LAND_VALUE       lon      lat maxFSR
                        <int>              <int>     <num>    <num>  <num>
 1:                    843000           11385000 -123.2214 49.27416      0
 2:                    727000           15921000 -123.2222 49.27408      0
 3:                    830000            9583000 -123.2212 49.27214      0
 4:                    146000            9360000 -123.2215 49.27073      0
 5:                    400000            3498000 -123.2086 49.27059      0
 6:                   1023000            3818000 -123.2085 49.26928      0
 7:                   5792000            7302000 -123.2076 49.27000      0
 8:                   2937000            6524000 -123.2076 49.26949      0
 9:                     52700            3383000 -123.2028 49.26066      0
10:                    426000            3672000 -123.2002 49.26400      0
11:                    426000            3672000 -123.2002 49.26400      0
12:                    152000            4164000 -123.1976 49.26430      0
13:                   1296000            3582000 -123.1974 49.26019      0
14:                     38600            2311000 -123.1944 49.25929      0
15:                  17413000           20631000 -123.2144 49.27521      0
16:                   3055000            5303000 -123.2103 49.27421      0
17:                   2174000            5684000 -123.1862 49.27201      0
18:                   2174000            5684000 -123.1862 49.27201      0
19:                  12272000           23271000 -123.2184 49.27559      0
20:                     18100            4278000 -123.2110 49.27396      0
    GEN_NET_IMPROVEMENT_VALUE GEN_NET_LAND_VALUE       lon      lat maxFSR
       disti  maxi
       <num> <num>
 1: 7232.214     0
 2: 7294.789     0
 3: 7223.972     0
 4: 7253.022     0
 5: 6320.300     0
 6: 6324.142     0
 7: 6249.357     0
 8: 6257.160     0
 9: 6079.713     0
10: 5810.138     0
11: 5810.138     0
12: 5620.460     0
13: 5718.314     0
14: 5539.506     0
15: 6723.563     0
16: 6422.074     0
17: 4679.347     0
18: 4679.347     0
19: 7017.567     0
20: 6477.548     0
       disti  maxi
> print(summary(df))
   FOLIO_ID         CONVEYANCE_DATE      CONVEYANCE_TYPE_DESCRIPTION
 Length:22159       Min.   :2023-01-03   Length:22159               
 Class :character   1st Qu.:2023-07-18   Class :character           
 Mode  :character   Median :2023-12-18   Mode  :character           
                    Mean   :2024-01-08                              
                    3rd Qu.:2024-07-08                              
                    Max.   :2024-12-31                              
                                                                    
 CONVEYANCE_PRICE   ACTUAL_USE_DESCRIPTION ROLL_NUMBER        JURISDICTION_CODE
 Min.   :       2   Length:22159           Length:22159       Min.   :200.0    
 1st Qu.: 1430000   Class :character       Class :character   1st Qu.:225.0    
 Median : 1758900   Mode  :character       Mode  :character   Median :311.0    
 Mean   : 2087478                                             Mean   :288.5    
 3rd Qu.: 2350000                                             3rd Qu.:320.5    
 Max.   :43706110                                             Max.   :745.0    
 NA's   :2                                                                     
 JURISDICTION         LAND_WIDTH       LAND_SIZE           LAND_DEPTH    
 Length:22159       Min.   : 16.50   Min.   :    0.128   Min.   : 33.04  
 Class :character   1st Qu.: 33.00   1st Qu.: 4792.000   1st Qu.:112.75  
 Mode  :character   Median : 37.16   Median : 7027.000   Median :122.00  
                    Mean   : 43.75   Mean   : 7131.959   Mean   :122.16  
                    3rd Qu.: 50.00   3rd Qu.: 8278.000   3rd Qu.:127.00  
                    Max.   :145.00   Max.   :73616.000   Max.   :320.00  
                    NA's   :17625    NA's   :4578        NA's   :17625   
 NEIGHBOURHOOD      REGIONAL_DISTRICT  TENURE_DESCRIPTION
 Length:22159       Length:22159       Length:22159      
 Class :character   Class :character   Class :character  
 Mode  :character   Mode  :character   Mode  :character  
                                                         
                                                         
                                                         
                                                         
 GEN_NET_IMPROVEMENT_VALUE GEN_NET_LAND_VALUE      lon              lat       
 Min.   :       0          Min.   :       0   Min.   :-123.4   Min.   :49.00  
 1st Qu.:   87900          1st Qu.: 1188000   1st Qu.:-123.1   1st Qu.:49.13  
 Median :  238000          Median : 1447000   Median :-122.9   Median :49.21  
 Mean   :  410982          Mean   : 1627354   Mean   :-122.9   Mean   :49.20  
 3rd Qu.:  556000          3rd Qu.: 1819000   3rd Qu.:-122.8   3rd Qu.:49.26  
 Max.   :17413000          Max.   :25138000   Max.   :-122.4   Max.   :49.47  
 NA's   :22                NA's   :22                                         
     maxFSR            disti            maxi  
 Min.   :0.00000   Min.   : 1285   Min.   :0  
 1st Qu.:0.00000   1st Qu.: 9455   1st Qu.:0  
 Median :0.00000   Median :21266   Median :0  
 Mean   :0.09797   Mean   :21844   Mean   :0  
 3rd Qu.:0.00000   3rd Qu.:33490   3rd Qu.:0  
 Max.   :5.00000   Max.   :54261   Max.   :0  
                                              
> df[,structureShare:=(GEN_NET_IMPROVEMENT_VALUE/(GEN_NET_IMPROVEMENT_VALUE+GEN_NET_LAND_VALUE))]
> print(summary(df[,structureShare]))
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's 
0.00000 0.05354 0.13922 0.18260 0.29452 1.00000      22 
> df[,teardown:=structureShare<0.05] # per merge natural value
> df[,assessedValue:=(GEN_NET_IMPROVEMENT_VALUE+GEN_NET_LAND_VALUE)]
> tearDown <- data.table(yearmon=date(),coef=numeric())
> 
> # conjecture about data structure: regular lots have land and depth
> df[,hasDepth:=(!is.na(LAND_DEPTH) & !is.na(LAND_WIDTH))]
> print(summary(feols(structureShare ~ hasDepth | paste0(JURISDICTION,NEIGHBOURHOOD),data=df)))
NOTE: 22 observations removed because of NA values (LHS: 22).
OLS estimation, Dep. Var.: structureShare
Observations: 22,137
Fixed-effects: paste0(JURISDICTION, NEIGHBOURHOOD): 225
Standard-errors: Clustered (paste0(JURISDICTION, NEIGHBOURHOOD)) 
              Estimate Std. Error t value Pr(>|t|)    
hasDepthTRUE -0.017616     0.0087 -2.0248 0.044074 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
RMSE: 0.125157     Adj. R2: 0.277396
                 Within R2: 5.249e-4
> print(summary(feols(teardown ~ hasDepth | paste0(JURISDICTION,NEIGHBOURHOOD),data=df)))
NOTE: 22 observations removed because of NA values (LHS: 22).
OLS estimation, Dep. Var.: teardown
Observations: 22,137
Fixed-effects: paste0(JURISDICTION, NEIGHBOURHOOD): 225
Standard-errors: Clustered (paste0(JURISDICTION, NEIGHBOURHOOD)) 
             Estimate Std. Error t value Pr(>|t|)    
hasDepthTRUE 0.056275   0.023814 2.36316 0.018975 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
RMSE: 0.385235     Adj. R2: 0.159469
                 Within R2: 5.654e-4
> 
> df[,window3:=CONVEYANCE_DATE >= as.Date("2023-08-01") & CONVEYANCE_DATE <= as.Date("2024-02-01") & yearmon(CONVEYANCE_DATE)!= yearmon("2023-11-01")]
> 
> for (m in sort(unique(df[,yearmon(CONVEYANCE_DATE)]))) {
+ 	print(m)
+ 	reg <- feols(log(CONVEYANCE_PRICE) ~ log(assessedValue)+teardown| JURISDICTION ^ NEIGHBOURHOOD,data=df[yearmon(CONVEYANCE_DATE)==m & hasDepth==1])
+ 	tearDown <- rbind(tearDown,data.table(yearmon=m,coef=coef(reg)["teardownTRUE"]))
+ }
[1] 2023
[1] 2023.083
[1] 2023.167
[1] 2023.25
[1] 2023.333
[1] 2023.417
[1] 2023.5
[1] 2023.583
[1] 2023.667
[1] 2023.75
NOTE: 1 observation removed because of NA values (RHS: 1).
[1] 2023.833
[1] 2023.917
[1] 2024
[1] 2024.083
[1] 2024.167
[1] 2024.25
[1] 2024.333
[1] 2024.417
[1] 2024.5
[1] 2024.583
[1] 2024.667
[1] 2024.75
[1] 2024.833
[1] 2024.917
> print(tearDown)
             yearmon         coef
              <char>        <num>
 1:             2023 -0.074821155
 2: 2023.08333333333 -0.080802906
 3: 2023.16666666667 -0.045837829
 4:          2023.25 -0.026897512
 5: 2023.33333333333 -0.038481923
 6: 2023.41666666667 -0.050930079
 7:           2023.5 -0.039361385
 8: 2023.58333333333 -0.042027668
 9: 2023.66666666667 -0.041352662
10:          2023.75 -0.063537373
11: 2023.83333333333 -0.072549856
12: 2023.91666666667 -0.072541263
13:             2024 -0.062913531
14: 2024.08333333333 -0.075312786
15: 2024.16666666667 -0.048955562
16:          2024.25 -0.007694849
17: 2024.33333333333 -0.049215327
18: 2024.41666666667 -0.034532086
19:           2024.5 -0.051222307
20: 2024.58333333333 -0.062753127
21: 2024.66666666667 -0.118400468
22:          2024.75 -0.067817185
23: 2024.83333333333 -0.059791516
24: 2024.91666666667 -0.082299071
             yearmon         coef
> df[is.na(LAND_SIZE),LAND_SIZE:=LAND_WIDTH*LAND_DEPTH]
> df[,smallLot:=LAND_WIDTH<30 | LAND_DEPTH<100]
> 
> # find tear-downs?
> di <- fread("data/derived/inventory2025.csv")
> print(nrow(df))
[1] 22159
> df <- merge(df,di,by.x=c("JURISDICTION_CODE","ROLL_NUMBER"),by.y=c("Jurisdiction","Roll_Number"),all.x=FALSE)
> print(nrow(df))
[1] 22145
> print(quantile(df[MB_Year_Built==2024,structureShare],probs=seq(.1,.95,.05)))
       10%        15%        20%        25%        30%        35%        40% 
0.01192733 0.01371461 0.01615776 0.01749585 0.01881625 0.02099131 0.02296194 
       45%        50%        55%        60%        65%        70%        75% 
0.02426573 0.02625821 0.02767519 0.03165303 0.03637241 0.03935804 0.04250234 
       80%        85%        90%        95% 
0.04842262 0.05626271 0.06697520 0.08200344 
> df[,newBuild:=MB_Year_Built==2024]
> print(df[,mean(hasDepth),by=newBuild])
   newBuild        V1
     <lgcl>     <num>
1:    FALSE 0.1990879
2:       NA 0.3812155
3:     TRUE 0.5372549
> df <- df[substring(Zoning,1,1)=="R" & !is.na(Zoning)]
> print(table(df[,JURISDICTION]))

  Bowen Island Municipality             City of Burnaby 
                         27                        1209 
          City of Coquitlam               City of Delta 
                       1270                        1497 
            City of Langley         City of Maple Ridge 
                        299                        1502 
    City of New Westminster     City of North Vancouver 
                        300                         280 
       City of Pitt Meadows      City of Port Coquitlam 
                        146                         507 
         City of Port Moody            City of Richmond 
                        235                        1287 
             City of Surrey           City of Vancouver 
                       4259                        3741 
         City of White Rock District of North Vancouver 
                        236                        1067 
 District of West Vancouver         Township of Langley 
                        676                        1621 
    Tsawwassen First Nation           Village of Anmore 
                          4                          35 
        Village of Belcarra 
                          7 
> print(table(df[maxFSR>0,JURISDICTION]))

  City of Burnaby  City of Richmond City of Vancouver 
               10                 1               649 
> 
> 
> df[,post:=CONVEYANCE_DATE >= as.Date("2023-11-01")]
> print(summary(feols(CONVEYANCE_PRICE ~ assessedValue + post*i(maxFSR)*teardown|NEIGHBOURHOOD+yearmon(CONVEYANCE_DATE),data=df[JURISDICTION=="City of Vancouver" & window3==1])))
NOTE: 1 observation removed because of NA values (RHS: 1).
The variables 'postTRUE', 'postTRUE:maxFSR::0', 'postTRUE:maxFSR::3', 'postTRUE:maxFSR::4', 'postFALSE:maxFSR::5', 'postTRUE:maxFSR::5' and 2 others have been removed because of collinearity (see $collin.var).
OLS estimation, Dep. Var.: CONVEYANCE_PRICE
Observations: 827
Fixed-effects: NEIGHBOURHOOD: 25,  yearmon(CONVEYANCE_DATE): 6
Standard-errors: Clustered (NEIGHBOURHOOD) 
                                     Estimate   Std. Error   t value   Pr(>|t|)
assessedValue                         1.03741 1.924900e-02 53.893742  < 2.2e-16
maxFSR::3                        -15012.33440 4.738216e+04 -0.316835 7.5411e-01
maxFSR::4                       -141506.13967 3.870429e+04 -3.656084 1.2502e-03
maxFSR::5                         -6407.71624 5.023727e+04 -0.127549 8.9957e-01
teardownTRUE                     261070.69971 4.308823e+04  6.058979 2.9478e-06
postFALSE:maxFSR::0              -90080.78828 5.340998e+04 -1.686591 1.0464e-01
postFALSE:maxFSR::3              -62768.77976 6.583622e+04 -0.953408 3.4989e-01
postFALSE:maxFSR::4             -117857.23791 4.151304e+04 -2.839042 9.0665e-03
postTRUE:teardownTRUE            -50231.80340 1.596785e+05 -0.314581 7.5580e-01
teardownTRUE:maxFSR::0          -346642.00053 4.116909e+04 -8.419958 1.2610e-08
teardownTRUE:maxFSR::3          -342354.53311 8.757721e+04 -3.909174 6.6264e-04
teardownTRUE:maxFSR::4           -67989.78195 1.027672e+05 -0.661590 5.1454e-01
postTRUE:teardownTRUE:maxFSR::0   27147.34848 1.785174e+05  0.152071 8.8040e-01
postTRUE:teardownTRUE:maxFSR::3  134450.46023 1.634560e+05  0.822548 4.1886e-01
                                   
assessedValue                   ***
maxFSR::3                          
maxFSR::4                       ** 
maxFSR::5                          
teardownTRUE                    ***
postFALSE:maxFSR::0                
postFALSE:maxFSR::3                
postFALSE:maxFSR::4             ** 
postTRUE:teardownTRUE              
teardownTRUE:maxFSR::0          ***
teardownTRUE:maxFSR::3          ***
teardownTRUE:maxFSR::4             
postTRUE:teardownTRUE:maxFSR::0    
postTRUE:teardownTRUE:maxFSR::3    
... 8 variables were removed because of collinearity (postTRUE, postTRUE:maxFSR::0 and 6 others [full set in $collin.var])
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
RMSE: 248,041.4     Adj. R2: 0.972535
                  Within R2: 0.9559  
> print(summary(feols(CONVEYANCE_PRICE ~ assessedValue + post*i(maxFSR)|NEIGHBOURHOOD+yearmon(CONVEYANCE_DATE),data=df[JURISDICTION=="City of Vancouver" & window3==1])))
NOTE: 1 observation removed because of NA values (RHS: 1).
The variables 'postTRUE', 'postTRUE:maxFSR::0', 'postTRUE:maxFSR::3', 'postTRUE:maxFSR::4', 'postFALSE:maxFSR::5' and 'postTRUE:maxFSR::5' have been removed because of collinearity (see $collin.var).
OLS estimation, Dep. Var.: CONVEYANCE_PRICE
Observations: 827
Fixed-effects: NEIGHBOURHOOD: 25,  yearmon(CONVEYANCE_DATE): 6
Standard-errors: Clustered (NEIGHBOURHOOD) 
                         Estimate   Std. Error   t value  Pr(>|t|)    
assessedValue             1.04875      0.01752 59.860355 < 2.2e-16 ***
maxFSR::3             24174.48532  39427.75765  0.613134  0.545555    
maxFSR::4             -2001.36342  82642.93555 -0.024217  0.980880    
maxFSR::5             31104.82473  41940.83862  0.741636  0.465504    
postFALSE:maxFSR::0 -205116.53069  97468.03911 -2.104449  0.045997 *  
postFALSE:maxFSR::3 -224965.67149 111419.01287 -2.019096  0.054781 .  
postFALSE:maxFSR::4 -293059.99463 140612.51465 -2.084167  0.047962 *  
... 6 variables were removed because of collinearity (postTRUE, postTRUE:maxFSR::0 and 4 others [full set in $collin.var])
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
RMSE: 251,465.7     Adj. R2: 0.972022
                  Within R2: 0.954674
> print(summary(feols(CONVEYANCE_PRICE ~ assessedValue + post*(maxFSR>3)|NEIGHBOURHOOD+yearmon(CONVEYANCE_DATE),data=df[JURISDICTION=="City of Vancouver" & window3==1])))
NOTE: 1 observation removed because of NA values (RHS: 1).
The variable 'postTRUE' has been removed because of collinearity (see $collin.var).
OLS estimation, Dep. Var.: CONVEYANCE_PRICE
Observations: 827
Fixed-effects: NEIGHBOURHOOD: 25,  yearmon(CONVEYANCE_DATE): 6
Standard-errors: Clustered (NEIGHBOURHOOD) 
                            Estimate   Std. Error   t value  Pr(>|t|)    
assessedValue                1.04886     0.017485 59.984294 < 2.2e-16 ***
maxFSR > 3TRUE          -51488.31242 33155.620792 -1.552929   0.13353    
postTRUE:maxFSR > 3TRUE  49071.07081 68696.593530  0.714316   0.48192    
... 1 variable was removed because of collinearity (postTRUE)
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
RMSE: 252,082.1     Adj. R2: 0.972026
                  Within R2: 0.954451
> print(summary(feols(CONVEYANCE_PRICE ~ assessedValue + post*(maxFSR>0)|NEIGHBOURHOOD+yearmon(CONVEYANCE_DATE),data=df[JURISDICTION=="City of Vancouver" & window3==1])))
NOTE: 1 observation removed because of NA values (RHS: 1).
The variable 'postTRUE' has been removed because of collinearity (see $collin.var).
OLS estimation, Dep. Var.: CONVEYANCE_PRICE
Observations: 827
Fixed-effects: NEIGHBOURHOOD: 25,  yearmon(CONVEYANCE_DATE): 6
Standard-errors: Clustered (NEIGHBOURHOOD) 
                           Estimate   Std. Error   t value  Pr(>|t|)    
assessedValue               1.04872     0.017434 60.154713 < 2.2e-16 ***
maxFSR > 0TRUE          -5666.40169 38254.015457 -0.148126   0.88348    
postTRUE:maxFSR > 0TRUE 25537.25310 40495.252760  0.630623   0.53425    
... 1 variable was removed because of collinearity (postTRUE)
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
RMSE: 252,145.3     Adj. R2: 0.972012
                  Within R2: 0.954429
> print(summary(feols(log(CONVEYANCE_PRICE) ~ log(assessedValue) + post*(maxFSR>0)|NEIGHBOURHOOD+yearmon(CONVEYANCE_DATE),data=df[JURISDICTION=="City of Vancouver" & window3==1])))
NOTE: 1 observation removed because of NA values (RHS: 1).
The variable 'postTRUE' has been removed because of collinearity (see $collin.var).
OLS estimation, Dep. Var.: log(CONVEYANCE_PRICE)
Observations: 827
Fixed-effects: NEIGHBOURHOOD: 25,  yearmon(CONVEYANCE_DATE): 6
Standard-errors: Clustered (NEIGHBOURHOOD) 
                         Estimate Std. Error   t value  Pr(>|t|)    
log(assessedValue)       1.014461   0.014535 69.795479 < 2.2e-16 ***
maxFSR > 0TRUE          -0.007304   0.015196 -0.480641   0.63512    
postTRUE:maxFSR > 0TRUE  0.019183   0.017786  1.078520   0.29152    
... 1 variable was removed because of collinearity (postTRUE)
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
RMSE: 0.073939     Adj. R2: 0.964298
                 Within R2: 0.922792
> print(summary(feols(CONVEYANCE_PRICE ~ assessedValue + post*structureShare|NEIGHBOURHOOD+yearmon(CONVEYANCE_DATE),data=df[maxFSR>2 & window3==1])))
The variable 'postTRUE' has been removed because of collinearity (see $collin.var).
OLS estimation, Dep. Var.: CONVEYANCE_PRICE
Observations: 149
Fixed-effects: NEIGHBOURHOOD: 14,  yearmon(CONVEYANCE_DATE): 5
Standard-errors: Clustered (NEIGHBOURHOOD) 
                             Estimate   Std. Error   t value   Pr(>|t|)    
assessedValue                 1.05121      0.03996 26.306858 1.1677e-12 ***
structureShare          -238933.40071 222410.42453 -1.074290 3.0223e-01    
postTRUE:structureShare -429428.02043 511313.40547 -0.839853 4.1617e-01    
... 1 variable was removed because of collinearity (postTRUE)
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
RMSE: 197,812.2     Adj. R2: 0.942646
                  Within R2: 0.86445 
> print(summary(feols(log(CONVEYANCE_PRICE) ~ log(assessedValue) + post*teardown|NEIGHBOURHOOD+yearmon(CONVEYANCE_DATE),data=df[maxFSR>2 & window3==1])))
The variable 'postTRUE' has been removed because of collinearity (see $collin.var).
OLS estimation, Dep. Var.: log(CONVEYANCE_PRICE)
Observations: 149
Fixed-effects: NEIGHBOURHOOD: 14,  yearmon(CONVEYANCE_DATE): 5
Standard-errors: Clustered (NEIGHBOURHOOD) 
                       Estimate Std. Error   t value   Pr(>|t|)    
log(assessedValue)     0.925839   0.050865 18.201838 1.2426e-10 ***
teardownTRUE          -0.027948   0.018107 -1.543532 1.4669e-01    
postTRUE:teardownTRUE -0.016548   0.047168 -0.350844 7.3133e-01    
... 1 variable was removed because of collinearity (postTRUE)
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
RMSE: 0.078521     Adj. R2: 0.928816
                 Within R2: 0.823281
> print(summary(feols(log(CONVEYANCE_PRICE) ~ log(assessedValue) + post*structureShare|NEIGHBOURHOOD+yearmon(CONVEYANCE_DATE),data=df[maxFSR>2 & window3==1])))
The variable 'postTRUE' has been removed because of collinearity (see $collin.var).
OLS estimation, Dep. Var.: log(CONVEYANCE_PRICE)
Observations: 149
Fixed-effects: NEIGHBOURHOOD: 14,  yearmon(CONVEYANCE_DATE): 5
Standard-errors: Clustered (NEIGHBOURHOOD) 
                         Estimate Std. Error   t value   Pr(>|t|)    
log(assessedValue)       0.966027   0.027647 34.941712 3.0611e-14 ***
structureShare           0.002769   0.072945  0.037958 9.7030e-01    
postTRUE:structureShare -0.108159   0.213541 -0.506499 6.2099e-01    
... 1 variable was removed because of collinearity (postTRUE)
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
RMSE: 0.07966     Adj. R2: 0.926736
                Within R2: 0.818117
> print(summary(feols(CONVEYANCE_PRICE ~ assessedValue + post*teardown|paste0(JURISDICTION,NEIGHBOURHOOD,yearmon(CONVEYANCE_DATE)),data=df[maxFSR>2])))
NOTE: 1 observation removed because of NA values (RHS: 1).
The variable 'postTRUE' has been removed because of collinearity (see $collin.var).
OLS estimation, Dep. Var.: CONVEYANCE_PRICE
Observations: 659
Fixed-effects: paste0(JURISDICTION, NEIGHBOURHOOD, yearmon(CONVEYANCE_DATE)): 218
Standard-errors: Clustered (paste0(JURISDICTION, NEIGHBOURHOOD, yearmon(CONVEYANCE_DATE))) 
                          Estimate  Std. Error   t value  Pr(>|t|)    
assessedValue              1.02017     0.04284 23.813727 < 2.2e-16 ***
teardownTRUE          -34188.13172 42310.61759 -0.808027   0.41996    
postTRUE:teardownTRUE -81019.01927 58205.82746 -1.391940   0.16537    
... 1 variable was removed because of collinearity (postTRUE)
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
RMSE: 272,483.0     Adj. R2: 0.887692
                  Within R2: 0.694192
> print(summary(feols(log(CONVEYANCE_PRICE) ~ log(assessedValue) + post*teardown|paste0(JURISDICTION,NEIGHBOURHOOD) + yearmon(CONVEYANCE_DATE),data=df[maxFSR>2])))
NOTE: 1 observation removed because of NA values (RHS: 1).
The variable 'postTRUE' has been removed because of collinearity (see $collin.var).
OLS estimation, Dep. Var.: log(CONVEYANCE_PRICE)
Observations: 659
Fixed-effects: paste0(JURISDICTION, NEIGHBOURHOOD): 18,  yearmon(CONVEYANCE_DATE): 24
Standard-errors: Clustered (paste0(JURISDICTION, NEIGHBOURHOOD)) 
                       Estimate Std. Error   t value   Pr(>|t|)    
log(assessedValue)     0.949979   0.038868 24.440939 1.1041e-14 ***
teardownTRUE          -0.038012   0.010137 -3.749652 1.5961e-03 ** 
postTRUE:teardownTRUE -0.008885   0.013475 -0.659372 5.1849e-01    
... 1 variable was removed because of collinearity (postTRUE)
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
RMSE: 0.123211     Adj. R2: 0.871521
                 Within R2: 0.706066
> print(summary(feols(CONVEYANCE_PRICE ~ assessedValue + post*teardown|paste0(JURISDICTION,NEIGHBOURHOOD,yearmon(CONVEYANCE_DATE)),data=df[hasDepth==1 & smallLot==0 & window3==1])))
NOTE: 1 observation removed because of NA values (RHS: 1).
The variable 'postTRUE' has been removed because of collinearity (see $collin.var).
OLS estimation, Dep. Var.: CONVEYANCE_PRICE
Observations: 884
Fixed-effects: paste0(JURISDICTION, NEIGHBOURHOOD, yearmon(CONVEYANCE_DATE)): 175
Standard-errors: Clustered (paste0(JURISDICTION, NEIGHBOURHOOD, yearmon(CONVEYANCE_DATE))) 
                           Estimate   Std. Error   t value   Pr(>|t|)    
assessedValue          9.905550e-01     0.021928 45.173023  < 2.2e-16 ***
teardownTRUE          -1.109557e+05 18285.331734 -6.068018 7.8756e-09 ***
postTRUE:teardownTRUE  1.437487e+03 67403.737316  0.021327 9.8301e-01    
... 1 variable was removed because of collinearity (postTRUE)
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
RMSE: 205,050.6     Adj. R2: 0.963226
                  Within R2: 0.921363
> print(summary(feols(log(CONVEYANCE_PRICE) ~ log(assessedValue) + post*teardown|paste0(JURISDICTION,NEIGHBOURHOOD,yearmon(CONVEYANCE_DATE)),data=df[hasDepth==1 & smallLot==0 & window3==1])))
NOTE: 1 observation removed because of NA values (RHS: 1).
The variable 'postTRUE' has been removed because of collinearity (see $collin.var).
OLS estimation, Dep. Var.: log(CONVEYANCE_PRICE)
Observations: 884
Fixed-effects: paste0(JURISDICTION, NEIGHBOURHOOD, yearmon(CONVEYANCE_DATE)): 175
Standard-errors: Clustered (paste0(JURISDICTION, NEIGHBOURHOOD, yearmon(CONVEYANCE_DATE))) 
                       Estimate Std. Error   t value   Pr(>|t|)    
log(assessedValue)     0.970484   0.013826 70.191460  < 2.2e-16 ***
teardownTRUE          -0.044756   0.006090 -7.349632 7.4261e-12 ***
postTRUE:teardownTRUE -0.010494   0.016836 -0.623319 5.3389e-01    
... 1 variable was removed because of collinearity (postTRUE)
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
RMSE: 0.05903     Adj. R2: 0.968893
                Within R2: 0.926417
> print(summary(feols(log(CONVEYANCE_PRICE) ~ log(assessedValue) + post*teardown|paste0(JURISDICTION,NEIGHBOURHOOD,yearmon(CONVEYANCE_DATE)),data=df[hasDepth==1 & smallLot==0])))
NOTE: 1 observation removed because of NA values (RHS: 1).
The variable 'postTRUE' has been removed because of collinearity (see $collin.var).
OLS estimation, Dep. Var.: log(CONVEYANCE_PRICE)
Observations: 3,995
Fixed-effects: paste0(JURISDICTION, NEIGHBOURHOOD, yearmon(CONVEYANCE_DATE)): 796
Standard-errors: Clustered (paste0(JURISDICTION, NEIGHBOURHOOD, yearmon(CONVEYANCE_DATE))) 
                       Estimate Std. Error   t value   Pr(>|t|)    
log(assessedValue)     0.943182   0.022754 41.450791  < 2.2e-16 ***
teardownTRUE          -0.049921   0.006344 -7.868933 1.1684e-14 ***
postTRUE:teardownTRUE  0.002273   0.010144  0.224081 8.2275e-01    
... 1 variable was removed because of collinearity (postTRUE)
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
RMSE: 0.213126     Adj. R2: 0.719656
                 Within R2: 0.469691
> print(summary(feols(log(CONVEYANCE_PRICE) ~ log(assessedValue) + post*teardown|paste0(JURISDICTION,NEIGHBOURHOOD,yearmon(CONVEYANCE_DATE)),data=df[hasDepth==0 | smallLot==1])))
NOTE: 16 observations removed because of NA values (LHS: 2, RHS: 14).
The variable 'postTRUE' has been removed because of collinearity (see $collin.var).
OLS estimation, Dep. Var.: log(CONVEYANCE_PRICE)
Observations: 16,193
Fixed-effects: paste0(JURISDICTION, NEIGHBOURHOOD, yearmon(CONVEYANCE_DATE)): 3,363
Standard-errors: Clustered (paste0(JURISDICTION, NEIGHBOURHOOD, yearmon(CONVEYANCE_DATE))) 
                       Estimate Std. Error  t value   Pr(>|t|)    
log(assessedValue)     0.928562   0.036181 25.66460  < 2.2e-16 ***
teardownTRUE          -0.047824   0.006938 -6.89317 6.4886e-12 ***
postTRUE:teardownTRUE  0.015942   0.007294  2.18572 2.8905e-02 *  
... 1 variable was removed because of collinearity (postTRUE)
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
RMSE: 0.108527     Adj. R2: 0.890158
                 Within R2: 0.730402
> print(summary(feols(log(CONVEYANCE_PRICE) ~ log(assessedValue) + post*teardown*smallLot|paste0(JURISDICTION,NEIGHBOURHOOD,yearmon(CONVEYANCE_DATE)),data=df[hasDepth==1])))
NOTE: 1 observation removed because of NA values (RHS: 1).
The variable 'postTRUE' has been removed because of collinearity (see $collin.var).
OLS estimation, Dep. Var.: log(CONVEYANCE_PRICE)
Observations: 4,391
Fixed-effects: paste0(JURISDICTION, NEIGHBOURHOOD, yearmon(CONVEYANCE_DATE)): 817
Standard-errors: Clustered (paste0(JURISDICTION, NEIGHBOURHOOD, yearmon(CONVEYANCE_DATE))) 
                                    Estimate Std. Error   t value  Pr(>|t|)    
log(assessedValue)                  0.951219   0.015737 60.444679 < 2.2e-16 ***
teardownTRUE                       -0.048502   0.005284 -9.179784 < 2.2e-16 ***
smallLotTRUE                       -0.004820   0.010735 -0.448993  0.653556    
postTRUE:teardownTRUE               0.004413   0.010818  0.407941  0.683424    
postTRUE:smallLotTRUE               0.048425   0.033442  1.448013  0.147997    
teardownTRUE:smallLotTRUE          -0.011993   0.017267 -0.694563  0.487527    
postTRUE:teardownTRUE:smallLotTRUE -0.077087   0.039985 -1.927891  0.054215 .  
... 1 variable was removed because of collinearity (postTRUE)
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
RMSE: 0.208976     Adj. R2: 0.7307  
                 Within R2: 0.494316
> print(summary(feols(log(CONVEYANCE_PRICE) ~ log(assessedValue) + post*teardown*LAND_SIZE|paste0(JURISDICTION,NEIGHBOURHOOD,yearmon(CONVEYANCE_DATE)),data=df)))
NOTE: 49 observations removed because of NA values (LHS: 2, RHS: 47).
The variable 'postTRUE' has been removed because of collinearity (see $collin.var).
OLS estimation, Dep. Var.: log(CONVEYANCE_PRICE)
Observations: 20,156
Fixed-effects: paste0(JURISDICTION, NEIGHBOURHOOD, yearmon(CONVEYANCE_DATE)): 3,677
Standard-errors: Clustered (paste0(JURISDICTION, NEIGHBOURHOOD, yearmon(CONVEYANCE_DATE))) 
                                    Estimate  Std. Error   t value   Pr(>|t|)
log(assessedValue)               0.923142970 0.032260084 28.615641  < 2.2e-16
teardownTRUE                    -0.051679654 0.012963847 -3.986444 6.8374e-05
LAND_SIZE                        0.000001461 0.000000941  1.552260 1.2069e-01
postTRUE:teardownTRUE           -0.008698756 0.017032871 -0.510704 6.0959e-01
postTRUE:LAND_SIZE               0.000001224 0.000001921  0.637233 5.2401e-01
teardownTRUE:LAND_SIZE           0.000000173 0.000001669  0.103648 9.1745e-01
postTRUE:teardownTRUE:LAND_SIZE  0.000002665 0.000002243  1.188265 2.3481e-01
                                   
log(assessedValue)              ***
teardownTRUE                    ***
LAND_SIZE                          
postTRUE:teardownTRUE              
postTRUE:LAND_SIZE                 
teardownTRUE:LAND_SIZE             
postTRUE:teardownTRUE:LAND_SIZE    
... 1 variable was removed because of collinearity (postTRUE)
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
RMSE: 0.138128     Adj. R2: 0.863055
                 Within R2: 0.653088
> 
> 
> proc.time()
   user  system elapsed 
 17.301   5.883   5.413 
